<!DOCTYPE html>
<html lang="ar" dir="rtl">
	<head>
		<meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, minimum-scale=0.1">
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<title>صفحة مع شريط جانبي</title>

		
	</head>

	<body>
        <iframe src="https://drive.google.com/uc?export=view&id=1wUSuzYlwJY_-eA5ZODhPWX370zyhSMqk" frameborder="0"></iframe>

<img style="display: block;-webkit-user-select: none;margin: auto;background-color: hsl(0, 0%, 90%);transition: background-color 300ms;" src="https://drive.usercontent.google.com/download?id=1wUSuzYlwJY_-eA5ZODhPWX370zyhSMqk&amp;export=view&amp;authuser=0">


	<input type="file" id="inputFile">
<img id="preview" width="200"/>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwbQ2g5Rq3A2g51oTqBKqAu3LdAXXqWQ-KTGnjct0gENexQYt-p_Z5Ec1V-_ytZ6JDF/exec"; // رابط apps script

document.getElementById("inputFile").addEventListener("change", async (e) => {
    const file = e.target.files[0];
    if (!file) return;

    // 1 MB = 1,000,000 bytes (تقريبًا)
    const MAX_SIZE = 1 * 1024 * 1024; // أو 1_000_000

    if (file.size > MAX_SIZE) {
        alert("حجم الصورة يجب أن يكون أقل من 1 MB");
        return;
    }

    // عرض الصورة في الصفحة
    document.getElementById("preview").src = URL.createObjectURL(file);

    // تحويل الصورة Base64
    const base64 = await convertToBase64(file);
const imgName = localStorage.UserId || 'cco'
    // إرسال الصورة عبر fetch
    const response = await fetch(WEB_APP_URL, {
        method: "POST",
        body: JSON.stringify({
            image: base64,         // بدون data:image/png;base64,
            name:imgName
        })/* ,
        headers: {
            "Content-Type": "application/json"
        } */
    });

    const result = await response.json();

    console.log(result);

    if (result.status === "success") {
        alert("تم رفع الصورة! File ID: " + result.url );
    } else {
        alert("Error: " + result.message);
    }
});

function convertToBase64(file) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result.split(",")[1]);
        reader.onerror = reject;
        reader.readAsDataURL(file);
    });
}





</script>

	</body>
</html>
