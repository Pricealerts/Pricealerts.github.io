async function handleCredentialResponse(e){let r=parseJwt(e.credential),t={action:"addAccontGogl",userId:r.sub,userName:r.name,userEmail:r.email,userPicture:r.picture,usergogl:!0};try{const e=await ftchFirebase(t);if("success"==e.status){const{userId:e,...s}=t;for(const e in s)localStorage[e]=s[e];saveImage(s.userPicture),r.sub=""}}catch(e){}}function parseJwt(e){var r=e.split(".")[1],t=r.replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(window.atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(s)}async function adedUser(){if(gebi("codeCnfrm").value.length<6)return gebi("errmsgCnfrm").innerText="رمز التحقق خاطئ أعد المحاولة",gebi("errmsgCnfrm").style.color="red",!1;gebi("errmsgCnfrm").innerText="جاري التحقق ...",gebi("errmsgCnfrm").style.color="black";const e=new Date,r=e.getTime(),t={action:"addAccont",userId:r,userName:userName,userEmail:userEmail,userPassword:userPassword,userPicture:"/imgs/web/apple-touch-icon.png",inputCode:gebi("codeCnfrm").value,signUp:!0},s=await ftchFirebase(t);if("success"==s.status){const{userPassword:e,userId:r,inputCode:s,signUp:n,...i}=t;for(const e in i)localStorage[e]=i[e];saveImage(i.userPicture),window.location.href=drction}}async function ftchFirebase(e){try{const r="https://europe-west1-pricealert-31787.cloudfunctions.net/proxyRequestV2/",t=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json(),n=JSON.parse(s);return console.log(n),n}catch(e){console.error("kayn error :"+e)}}import{initializeApp}from"firebase/app";import{getAnalytics}from"firebase/analytics";import{getAuth,signInWithEmailAndPassword,createUserWithEmailAndPassword,signInWithPopup,GoogleAuthProvider,onAuthStateChanged}from"https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";const firebaseConfig={apiKey:"AIzaSyDIR4H7Jk3bJN_QZp-Cs4CbqpRmsKkUTxc",authDomain:"pricealert-31787.firebaseapp.com",databaseURL:"https://pricealert-31787-default-rtdb.europe-west1.firebasedatabase.app",projectId:"pricealert-31787",storageBucket:"pricealert-31787.firebasestorage.app",messagingSenderId:"200237716010",appId:"1:200237716010:web:65a9e33254d2302339a953",measurementId:"G-L693265WLN"};import{getFunctions,httpsCallable}from"firebase/functions";const app=initializeApp(firebaseConfig),analytics=getAnalytics(app),provider=new GoogleAuthProvider;document.getElementById("googleBtn").addEventListener("click",()=>{signInWithPopup(auth,provider).then(async e=>{console.log("Logged in!");const r=getFunctions(),t=httpsCallable(r,"createUserProfile");await t({userType:"trader",phoneNumber:"0555555555"}),console.log("Profile created in Database!")}).catch(e=>{console.error("Error:",e)})}),document.getElementById("googleBtn").addEventListener("click",()=>{signInWithPopup(auth,provider).then(async e=>{const r=e.user.uid;console.log("Logged in!"),console.log("My User ID is:",r);const t=getFunctions(),s=httpsCallable(t,"createUserProfile");await s({userType:"trader",phoneNumber:"0555555555"}),console.log("Profile created in Database for user:",r)}).catch(e=>{console.error("Error:",e)})}),window.onload=function(){function e(e){google.accounts.id.renderButton(document.getElementById(e),{theme:"outline",size:"large"})}google.accounts.id.initialize({client_id:"200237716010-fsre2cg3a1dgm666mb1qcq6gdhntl2sd.apps.googleusercontent.com",callback:handleCredentialResponse}),e("buttonSignUp"),e("buttonSignIn"),google.accounts.id.prompt()},gebi("btnSignIn").addEventListener("click",async e=>{e.preventDefault();const r=document.querySelectorAll("#frmSgnIn input");if(userEmail=r[0].value,userPassword=r[1].value,!userEmail.length||!userPassword.length)return gebi("errmsgsgnIn").innerText="عليك ملأ البيانات",gebi("errmsgsgnIn").style.color="red",!1;const t={action:"getAccont",userEmail:userEmail,userPassword:userPassword},s=await ftchFirebase(t);if("success"==s.status){const e=s.rslt;for(const r in e)localStorage[r]=e[r];saveImage(localStorage.userPicture),window.location.href=drction}else"NoPassword"==s.status||"notexsist"==s.status?(gebi("errmsgsgnIn").innerText="  كلمة السر أو الإيميل خاطئ يرجى التأكد من الحساب",gebi("errmsgsgnIn").style.color="red"):console.log("rah flelse")}),gebi("btnCnfrmInEmail").addEventListener("click",async e=>{const r=document.querySelectorAll("#msgCnfrmInEmail input");userEmail=r[0].value,gebi("errmsgCnfrmInEmail").innerText="جاري الإرسال...",gebi("errmsgCnfrmInEmail").style.color="black";try{const e=await ftchFirebase({action:"sndMsgCnferIn",userEmail:userEmail});if("notexsist"==e.status)return gebi("errmsgCnfrmInEmail").innerText="هذا الحساب غير موجود",gebi("errmsgCnfrmInEmail").style.color="red",setTimeout(()=>{activateSignUp()},2e3),!1;if("notSend"==e.status)return gebi("errmsgCnfrmInEmail").innerText="الإيمل خاطئ تأكد منه وأعد المحاولة",gebi("errmsgCnfrmInEmail").style.color="red",!1;"success"==e.status&&(gebi("msgCnfrmIn").style.transform="translateY(0%)",gebi("errmsgCnfrmInEmail").innerText="")}catch(e){return console.log("err rspnsCnfrm"+e),!1}}),gebi("btnCnfrmIn").addEventListener("click",async e=>{gebi("errmsgCnfrmIn").innerText="جاري التحقق ...",gebi("errmsgCnfrmIn").style.color="black";try{const e=await ftchFirebase({action:"cnfrmCode",userEmail:userEmail,inputCode:gebi("codeCnfrmIn").value,signUp:!1});if("overNmber"==e.status)return gebi("errmsgCnfrmIn").innerText="لقد قمت بالمحاولة أكثر من 4 مرات  أعد المحاولة بعد ساعة",gebi("errmsgCnfrmIn").style.color="red",!1;if("notExist"==e.status)return gebi("errmsgCnfrmIn").innerText="رمز التحقق خاطئ أعد المحاولة",gebi("errmsgCnfrmIn").style.color="red",!1;if("exist"==e.status)return gebi("errmsgCnfrmIn").innerText="",gebi("newPswrd").style.transform="translateY(0%)",!1}catch(e){return console.log("error appscript : "+e),!1}}),gebi("btnNewPswrd").addEventListener("click",async e=>{gebi("errNewPswrd").innerText="جاري التحديث ...",gebi("errNewPswrd").style.color="black";try{const e=await ftchFirebase({action:"updtPsw",userEmail:userEmail,userPassword:gebi("inptNewPswrd").value});if("notExist"==e.status&&(gebi("errNewPswrd").innerText="إيميلك غير موجود أعد انشاء حساب من جديد",gebi("errNewPswrd").style.color="red",setTimeout(()=>{activateSignUp()},2e3)),"success"==e.status){const r=e.rslt;for(const e in r)localStorage[e]=r[e];saveImage(localStorage.userPicture),window.location.href=drction}else gebi("errmsgsgnIn").innerText="حدث خطأ أعد المحاولة ",gebi("errmsgsgnIn").style.color="red",console.error(e.status)}catch(e){return console.log("error btnNewPswrd : "+e),!1}});const lstLoclSrorge=["action","userId","userName","userEmail","userPassword","userPicture","chtId1","chtId2","chtId3","paid","base64Pctr"];for(let e=0;e<lstLoclSrorge.length;e++){const r=lstLoclSrorge[e];localStorage.removeItem(r)}const drction="../accont/";gebi("btnSignUp").addEventListener("click",async()=>{const e=document.querySelectorAll("#frmSgnUp input");userName=e[0].value,userEmail=e[1].value,userPassword=e[2].value,gebi("errmsgsgnUp").innerText="جاري التسجيل ...",gebi("errmsgsgnUp").style.color="black";try{const e=await ftchFirebase({action:"sndMsgCnfer",userEmail:userEmail,userName:userName});if("exist"==e.status)return gebi("errmsgsgnUp").innerText="هذا الحساب موجود بالفعل قم بتسجيل الدخول",gebi("errmsgsgnUp").style.color="red",setTimeout(()=>{activateSignIn()},2e3),!1;"success"==e.status?gebi("msgCnfrm").style.transform="translateY(0%)":"notSend"==data.status?(gebi("errmsgsgnUp").innerText="الإيمل خاطئ تأكد منه وأعد المحاولة",gebi("errmsgsgnUp").style.color="red"):(gebi("errmsgsgnUp").innerText="حدث خطأ أعد المحاولة",gebi("errmsgsgnUp").style.color="red")}catch(e){return console.error("err rspnsCnfrm"+e),!1}}),gebi("btnCnfrm").addEventListener("click",async()=>{console.log("ddd"),await adedUser()});