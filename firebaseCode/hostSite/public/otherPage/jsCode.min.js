function vrfInpt(e){e.addEventListener("input",()=>{const e=valInpts();e!=prmyrInpts?(gebi("saveBtn").style.backgroundColor="#007bff",gebi("saveBtn").style.cursor="pointer"):(gebi("saveBtn").style.backgroundColor="#444",gebi("saveBtn").style.cursor="not-allowed")})}async function updateUserData(e){const t=ref(db,"users/"+userId);try{return await update(t,e),console.log("تم التسجيل وتعديل البيانات ✔️"),!0}catch(e){return console.error("حدث خطأ في التحديث:",e),gebi("rspns").innerText="حدث خطأ أعد المحاولة",gebi("rspns").style.color="red",!1}}function name(e){}function base64ToBlob(e){const t=e.split(","),r=t[0].match(/:(.*?);/)[1],n=atob(t[1]),s=[];for(let e=0;e<n.length;e++)s.push(n.charCodeAt(e));return new Blob([new Uint8Array(s)],{type:r})}import{auth,onAuthStateChanged,db,ref,update,signOut,updateProfile,storage,storageRef,uploadBytes,getDownloadURL}from"https://pricealerts.github.io/firebaseCode.js";let userId,userBr;gebi("sgnOutInLink").addEventListener("click",async()=>{await onAuthStateChanged(auth,async e=>{if(e){const t=ref(db,"users/"+e.uid);await update(t,{lastLogout:(new Date).toISOString(),status:"outline"}),await signOut(auth)}localStorage.clear(),window.location.href="/signin"})}),gebi("userName").addEventListener("input",()=>{console.log("dddddd")}),slctAll(".inptSave").forEach(e=>vrfInpt(e)),gebi("formSave").addEventListener("submit",async e=>{if(e.preventDefault(),gebi("rspns").innerText="جاري الحفظ ...",gebi("rspns").style.color="black",gebi("userName").innerText.length<2)return gebi("rspns").innerText="  خانة الإسم فارغة عليك ملأها ",gebi("rspns").style.color="red",setTimeout(()=>{gebi("rspns").innerText=""},15e3),!1;if(gebi("chtId1").value.length+gebi("chtId2").value.length+gebi("chtId3").value.length==0)return gebi("rspns").innerText="  لم تسجل أي chat Id ",gebi("rspns").style.color="red",setTimeout(()=>{gebi("rspns").innerText=""},5e3),!1;const t={userName:gebi("userName").innerText||"",chtId1:gebi("chtId1").value||"",chtId2:gebi("chtId2").value||"",chtId3:gebi("chtId3").value||""};if(file){if(!userBr)return alert("يجب تسجيل الدخول");const e=base64ToBlob(file),r=storageRef(storage,`avatars/${userBr.uid}`);await uploadBytes(r,e);const n=await getDownloadURL(r);await updateProfile(userBr,{photoURL:n}),console.log("تم تغيير الصورة بنجاح ✅"),t.userPicture="frbsStrg",localStorage.base64Pctr=file}let r=!0;for(const e in t)localStorage[e]!=t[e]&&(localStorage[e]=t[e],r=!1);r&&!file&&(gebi("rspns").innerText="لم تغير شيء لحفظه",gebi("rspns").style.color="black");try{t.userPicturec="";const e=await updateUserData(t);e&&(gebi("rspns").innerText="تم الحفظ بنجاح",gebi("rspns").style.color="green",setTimeout(()=>{gebi("rspns").innerText="",window.location.href="https://pricealerts.web.app"},3e3))}catch(e){console.error("حدث خطأ في الرفع:",e),gebi("rspns").innerText="حدث خطأ أعد المحاولة",gebi("rspns").style.color="red"}file=null}),console.log("hadi jdida 10");