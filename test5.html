<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
  <!-- Firebase App -->
<script type="module">
  // استيراد Firebase SDKs
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import { getAuth, reauthenticateWithCredential, EmailAuthProvider, updatePassword } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";

  // إعدادات Firebase الخاصة بك
  const firebaseConfig = {
				apiKey: "AIzaSyCL11Nbo54WUlFCGN3raQB-AsVWfR2_guM",
				authDomain: "alertprice-c0176.firebaseapp.com",
				projectId: "alertprice-c0176",
				storageBucket: "alertprice-c0176.firebasestorage.app",
				messagingSenderId: "48895497565",
				appId: "1:48895497565:web:8b7c5e16335812f6c344b4",
				measurementId: "G-YV336XXHKP",
			};

  // تهيئة Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // تغيير كلمة السر
  window.changePassword = function () {
    const user = auth.currentUser;

    const currentPassword = document.getElementById("currentPassword").value;
    const newPassword = document.getElementById("newPassword").value;

    if (user) {
      // إنشاء بيانات لتوثيق المستخدم
      const credential = EmailAuthProvider.credential(user.email, currentPassword);

      // إعادة التوثيق باستخدام بيانات البريد الإلكتروني الحالية وكلمة السر
      reauthenticateWithCredential(user, credential)
        .then(() => {
          // إذا تم التوثيق بنجاح، نغير كلمة السر
          updatePassword(user, newPassword)
            .then(() => {
              alert("تم تغيير كلمة السر بنجاح.");
            })
            .catch((error) => {
              alert("حدث خطأ أثناء تغيير كلمة السر: " + error.message);
            });
        })
        .catch((error) => {
          alert("كلمة السر الحالية غير صحيحة: " + error.message);
        });
    } else {
      alert("يجب أن تكون مسجلاً الدخول أولاً.");
    }
  }
</script>

</head>
<body>
<div style="width: 300px; margin: 50px auto; text-align: center;">
  <h2>تغيير كلمة السر</h2>

  <!-- كلمة السر الحالية -->
  <input 
    type="password" 
    id="currentPassword" 
    placeholder="أدخل كلمة السر الحالية" 
    style="width: 100%; padding: 10px; margin-bottom: 10px;"/>

  <!-- كلمة السر الجديدة -->
  <input 
    type="password" 
    id="newPassword" 
    placeholder="أدخل كلمة السر الجديدة" 
    style="width: 100%; padding: 10px; margin-bottom: 10px;"/>

  <button 
    onclick="changePassword()" 
    style="width: 100%; padding: 10px;">
      تغيير كلمة السر
  </button>
</div>


</body>
</html>